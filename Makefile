PYC=pyinstaller
BUILD_DIR=./build
DIST_DIR=./dist
PROG_EXTENSION=.app
BUILD_OPT=--workpath $(BUILD_DIR)
DIST_OPT=--distpath $(DIST_DIR)
OPTIONS=--clean --onefile --specpath ./build

client:
	$(PYC) ./$@.py $(DIST_OPT) $(BUILD_OPT) $(OPTIONS) -n $@$(PROG_EXTENSION)

docker: client
	docker build -f Dockerfile.server -t secu_server .;
	docker build -f Dockerfile.client -t secu_client .;

run_server:
	docker run -it --rm --name s-server secu_server

server_bash:
	docker exec -it s-server bash

run_client:
	docker run -it --rm --name s-client --link s-server:server secu_client
