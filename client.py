import requests
import argparse
import getpass
import socket

def get_user_ip() -> str:
    tmp = ''
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect(("1.1.1.1", 80))
    tmp = s.getsockname()
    s.close
    return tmp

def main():

    parser = argparse.ArgumentParser(description='ip/username sender\n',
                                     epilog='send ip and username to server')

    
    parsed_args = parser.parse_args()

    r = requests.post("http://127.0.0.1:1234/",
                      data={'ip': get_user_ip(), 'name': getpass.getuser()})
    # And done.
    print(r.text)  # displays the result body.


if __name__ == '__main__':
    main()
